<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="782px" height="1979px" viewBox="-0.5 -0.5 782 1979" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2021-05-25T14:07:50.114Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36&quot; etag=&quot;W0kJ3LcKh_PFht-WieyK&quot; version=&quot;14.6.11&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;6f77arHMxLuqO6wJHb2z&quot; name=&quot;Page-1&quot;&gt;7Vxbj6O4Ev41aGYfugWYmx8hyeyOtOdopZHO7DyS4CT0EMgSerqzv/6Uzd02CZ0LdLpbGvWAg8uF6+KqrypR0GTz/Hvqb9f/SQISKboaPCtoqui6phoq/EdH9vmIqZr5wCoNg+KheuBb+C8pZxajj2FAdq0HsySJsnDbHlwkcUwWWWvMT9Pkqf3YMonaq279FREGvi38SBz9HgbZOh91dLse/4OEq3W5smbh/JONXz5cvMlu7QfJU2MIzRQ0SZMky682zxMS0c0r9yWf96Xj04qxlMRZnwmOjzZf/5p8/f7w42n7x2714Giru3Kbf/nRY/HGBbfZvtwCEsCOFLdJmq2TVRL70awe9dLkMQ4IXUeFu/qZP5NkC4MaDD6QLNsX4vUfswSG1tkmKj7N16QLdb5cMbRLHtMFOfBGRrW1oJMk2ZAs3cO8lER+Fv5q0/cL5VhVz1VT/0pCWFlXC0U2LSufUqoxUtskMj9dkayYVUsBLhps1ENMNi+RkybIiUQ7QqctP8PfB4VK3/I3sN/eKmNbqkb+LvsKgnmG69+kYv3Tn4O9tkThR+EqhusF7DxJYeAXSbMQDMItPtiEQZBLnezCf/05o0flvqUvz7bD9BRzWomVEiDPisRai8m1jTQFfkBfRfEW5O/U+9K/7FsLnir+8pFkudyRq0jWEA1wZivuhP6bGYrnKI6qzCw2oikzU/FmiuvSZxy4+AJCj6i45ylcMcHXUp9hxfMU7CgzR3HhYYNRnioOZpRdoKCK8+kaDvxz6KrwqDeLyXP2v/+Ca6fzMUwzZCyyC8pZPh3RZzxDcVVDXKOieP+T7OkMrCvOZJuSX41RTIl4U5HpBeUMA3VLpBxSQ6DbqFKV/Byyd9cU12FkKIHG2wibWdGtXzR/P4+JQFUc+zdxzYdqTZ2u+SCuWb3ZyWtyxtv2uE/rMCPftj5zjE9wELdNehlG0SSJkpTNRYFJnMCA8V2WJj9J4xNHnyNwdAcMV/DInaZoWGrLEFFp40/1MVqd8uvmEcq71qZ5tqzvxU5Ulxx2uTB3Wz8WDagU60PlWuP5bsv2J58GbDRnSoxJQp/pwFTBiJkKaPm0YbK8ruudS92gRmjyM3REjUC9NKK0yCm1bA+kB6euzHFiBU+YLwT7B9+pMXHa1AlTSbvMIzj0wmFOHv56eAj5LpdLfbGQyTew5pZ5Ifk6Rlu+r8HiJaerRL61exaFatNIip5HyP3kf1L0SUHL/aR9og7CnnZbfYd7aI016c9b9HWO/mnOpkl/0aJvXJx+0KKPjtG/QQ/WPtPw+Apu9lLwOuY5rOCHFeR8BT9sQIMr4Ivpv9BAb07BeRf+ChTcEhRckvFG/TLeOHApJESzW3hyFy7aWw6blO7/LsTDbn7Qm3uzvJ0+Nz+c7su75zD7u6QB141ZcFdPojflHOXCiIeu5gjE0WBHlH1DuKZEtuXYmQiKpXLRgcOpTP6eAoIiEjI5QgNDMbosZrxpyEw35YpxYcwM8xK/tqDE4O9dYmZ6h93fLmamS6KeFiIFGdbkVNCsMwNvZno9kbGcj05kTLs0Mub3Qsa0EZAx9QMZ68JBbGP0KEsXoywR8wDnSWGPm8Ml+P2uzqER99uWxBAy3OkcRKk2w5Qs8+SvMEZq6JN1GAWwhXDwhHcanD33JLqnH3wL51EYr+SFAexRu8tVw2MeDfhzna2fLdaziGyoSKh7AlYmtStjNeF8aWbvcTl4FooKHHxRMK7W6yAnfVnmwSd0Xu1bLFoqcb9IyhXy9S1aI8Ea2w2PefziVGCyAe7UDo7oHlQcldwbFSdNIZQ7jToPoaL0AgyYvJilk1ixpjhR4lo41PuqiqdV29BwzAVfktNKvjE23U7qtkE7VOrLc05Bb3P370wglsn8MCbpfRjvwLY9skxS8rnNVJdAq9cU15YcQZQLd6bgGTMmTE9ggZ2GEvDb0MFDxwvAFk2QjAnZPvVHVW7uiONxBFsTXa6hylwuvprLdQSXez0g4QRA4FTw4eJ5YA8kIT++XguS4PDHdF8kwdHbcK7NK9+1E1TcKwo4VJ24yULDcf7PKbq82+oERh14y3hxbkn4IFbWG5WtfeGPlis8jMrWjvdHwyVfHZUtQ/zjzhSP6UxtzDnTU2FZTUVcmmUN602RLslhLZqxeHlwbzUi8tzUG2po/fNIGzG9JQR2dzsGuroUKtG3eRsI9SNzf/FzxfzA3SI3YfpIupp/1g2HRRHAuaobuL42afRQ0haCx76+5yZhR3S0VU9rw4536DyNLsgY7QnXQyFRn0LA23RuZSfVcefWUVoYxrmZHPJj2afWnLiQ0xo4UkSyPpYTk5KXqMyp6nlJVeublHQ0fg+jaZjrDNH5w6+vpplGmxBS+2kaiN7fNx4rPHw3w0Y7WIQU/TBflnnoebjIObis2ktg6QNqHycx6XKvL0uqR67ol21rx0v6o7pXW297Re3U2NG2OUIDl/SRDI6XxGC3U9JHHUnFhUv6mlF+3WkoSYko3rus6aMOBO52a/pIAobx3zLBr6Gm75SE5DV9SdHlvJp+0Kumr0uBurr+jm4T0+Jrt5pegqbjgVqGDNR65V8jQW8H5hRUojqDRlQJEXt6Z8Wl4+mZM2aoatkG50cwhxP1jVWxqh6hdOUQyOgTrN4k7HRUh7qi2mF0SFO5qramlTjYi7N807rHtnCyVUHbhZN9CeeWephBPtDnJlwn3zfE6F5+8n18He/4OcmXA19D6FS27r+dRNvsaK4+O9Hm0jdcZr4DnTKmGNG8y0TbPGxkN5hom5KyVZ3gshZP7F0q0e7uWzySaFd8dCbakhz+vER73ivRpon00M3zrGH/o3k+z/648NvCzuinmuw3XN5O9zy34dVJNOKG9/vW80f7/Ajt8zKPP0D7PGq4N5D6VHFZ94+nszPMYnqA+c56YFzi64831sePUSSbd3pvvQyQ/uitb70AbNGEbvxHe73uGPwhaIk+eeD+enPIL+q/Sgj05FxxqLZ5Tmlsh0spe/fN8+pnW2jY5LTf1+eu3jh/+V/QWZz5C0PdjfN8v/vJjfNv71dPMOoCW0YMcWVQ6PtA+c1Rv11U/2Rx1dVknugnNRXxuZM2MIona6r46IkfD03sKIK+mZ74EiwYw21dMFIrXcBxXzVqSGfqfCBmnOiqTLsLVjvbU8Ft/SPn+eP1T8Wj2f8B&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g><path d="M 105 360 L 105 400 L 106 400 L 106 433.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 106 438.88 L 102.5 431.88 L 106 433.63 L 109.5 431.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 399px; margin-left: 107px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">else if( j &gt; lastIndex )</div></div></div></foreignObject><text x="107" y="402" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">else if( j &gt; lastIndex )</text></switch></g><rect x="0" y="230" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 295px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">第一次循环<br />lastIndex默认等于0<br />先找nextVNode的第一个元素4<br />nextVNode.key和prevVNode.key都等于c时<br />i = 0;(i表示nextVNode循环时的下标)<br />j = 2;(j表示prevVNode循环时的下标)</div></div></div></foreignObject><text x="105" y="299" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">第一次循环lastIndex默认等于0...</text></switch></g><rect x="1" y="440" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 505px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>lastIndex = j </span><br /><span>当前lastIndex等于2</span></div></div></div></foreignObject><text x="106" y="509" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">lastIndex = j...</text></switch></g><rect x="381" y="230" width="210" height="130" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 295px; margin-left: 382px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>不走if<br />需要移动节点</span></div></div></div></foreignObject><text x="486" y="299" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">不走if...</text></switch></g><rect x="0" y="0" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 65px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>prevVNode<br />{ key:'a',value:'1' }<br /></span><span>{ key:'b',value:'2' }</span><br /><span>{ key:'c',value:'4' }</span><br /><span>{ key:'d',value:'3' }</span></div></div></div></foreignObject><text x="105" y="69" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">prevVNode...</text></switch></g><rect x="381" y="0" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 65px; margin-left: 382px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>nextVNode<br />{ key:'c',value:'4' }<br /></span><span>{ key:'a',value:'1' }</span><br /><span>{ key:'d',value:'3' }</span><br /><span>{ key:'b',value:'2' }</span></div></div></div></foreignObject><text x="486" y="69" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">nextVNode...</text></switch></g><path d="M 210 295 L 374.63 295" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 379.88 295 L 372.88 298.5 L 374.63 295 L 372.88 291.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 295px; margin-left: 296px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">if( j &lt; lastIndex )</div></div></div></foreignObject><text x="296" y="298" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">if( j &lt; la...</text></switch></g><path d="M 106 780 L 106 883.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 106 888.88 L 102.5 881.88 L 106 883.63 L 109.5 881.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 833px; margin-left: 108px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">else if( j &gt; lastIndex )</div></div></div></foreignObject><text x="108" y="836" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">else if( j &gt; lastIndex )</text></switch></g><rect x="1" y="650" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 715px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">第二次循环<br />lastIndex等于2<br />找nextVNode的第二个元素1<br />nextVNode.key和prevVNode.key都等于a时<br />i = 1;(i表示nextVNode循环时的下标)<br />j = 0;(j表示prevVNode循环时的下标)</div></div></div></foreignObject><text x="106" y="719" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">第二次循环lastIndex等于2...</text></switch></g><rect x="1" y="890" width="210" height="130" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 955px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">不走elsif</div></div></div></foreignObject><text x="106" y="959" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">不走elsif</text></switch></g><rect x="381" y="620" width="400" height="190" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 398px; height: 1px; padding-top: 715px; margin-left: 382px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>需要移动节点<br />refNode = nextChildren[i-1].el.nextSibling<br />因为在patchElement里nextVNode.el = prevVnode.el</span><br /><span>这里</span>nextChildren[i-1]指的是4<br /><span>我们找到</span>prevChildren里4的nextSibling为3<br />所以refNode = 3<br />而prevVnode.el 就是prevVNode的1<br /><span>然后执行container.insertBefore(prevVnode.el,</span>refNode<span>)<br />实际执行的就是</span>container.insertBefore(1,3)<br /><span><br /></span></div></div></div></foreignObject><text x="581" y="719" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">需要移动节点refNode = nextChildren[i-1].el.nextSibling...</text></switch></g><path d="M 211 715 L 374.63 715" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 379.88 715 L 372.88 718.5 L 374.63 715 L 372.88 711.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 715px; margin-left: 296px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">if( j &lt; lastIndex )</div></div></div></foreignObject><text x="296" y="718" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">if( j &lt; la...</text></switch></g><rect x="476" y="890" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 955px; margin-left: 477px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>prevVNode<br /></span><span>{ key:'b',value:'2' }</span><br /><span>{ key:'c',value:'4' }<br /></span>{ key:'a',value:'1' }<br /><span>{ key:'d',value:'3' }</span></div></div></div></foreignObject><text x="581" y="959" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">prevVNode...</text></switch></g><path d="M 581 810 L 581 883.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 581 888.88 L 577.5 881.88 L 581 883.63 L 584.5 881.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 849px; margin-left: 579px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">更新<span style="font-size: 12px ; background-color: rgb(248 , 249 , 250)">container</span></div></div></div></foreignObject><text x="579" y="852" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">更新container</text></switch></g><path d="M 106 570 L 106 643.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 106 648.88 L 102.5 641.88 L 106 643.63 L 109.5 641.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 486 130 L 486 171 Q 486 181 476 181 L 115 181 Q 105 181 105 191 L 105 223.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 105 228.88 L 101.5 221.88 L 105 223.63 L 108.5 221.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 210 65 L 381 65" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 106 1269 L 106 1372.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 106 1377.88 L 102.5 1370.88 L 106 1372.63 L 109.5 1370.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1322px; margin-left: 108px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">else if( j &gt; lastIndex )</div></div></div></foreignObject><text x="108" y="1325" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">else if( j &gt; lastIndex )</text></switch></g><rect x="1" y="1139" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 1204px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">第三次循环<br />lastIndex等于2<br />找nextVNode的第三个元素3<br />nextVNode.key和prevVNode.key都等于d时<br />i = 2;<br />j = 3;</div></div></div></foreignObject><text x="106" y="1208" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">第三次循环lastIndex等于2...</text></switch></g><rect x="1" y="1379" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 1444px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>lastIndex = j </span><br /><span>当前lastIndex等于3</span></div></div></div></foreignObject><text x="106" y="1448" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">lastIndex = j...</text></switch></g><path d="M 214 1204 L 469.63 1204" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 474.88 1204 L 467.88 1207.5 L 469.63 1204 L 467.88 1200.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1204px; margin-left: 345px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">if( j &lt; lastIndex )</div></div></div></foreignObject><text x="345" y="1207" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">if( j &lt; la...</text></switch></g><path d="M 581 1022 L 581 1060 Q 581 1070 571 1070 L 116 1070 Q 106 1070 106 1080 L 106 1132.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 106 1137.88 L 102.5 1130.88 L 106 1132.63 L 109.5 1130.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="476" y="1139" width="210" height="130" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 1204px; margin-left: 477px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>不走if<br />需要移动节点</span></div></div></div></foreignObject><text x="581" y="1208" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">不走if...</text></switch></g><path d="M 105 1738 L 105 1841.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 105 1846.88 L 101.5 1839.88 L 105 1841.63 L 108.5 1839.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1791px; margin-left: 107px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">else if( j &gt; lastIndex )</div></div></div></foreignObject><text x="107" y="1794" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">else if( j &gt; lastIndex )</text></switch></g><rect x="0" y="1608" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 1673px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">第四次循环<br />lastIndex等于3<br />找nextVNode的第四个元素2<br />nextVNode.key和prevVNode.key都等于b时<br />i = 3;(i表示nextVNode循环时的下标)<br />j = 1;(j表示prevVNode循环时的下标)</div></div></div></foreignObject><text x="105" y="1677" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">第四次循环lastIndex等于3...</text></switch></g><rect x="0" y="1848" width="210" height="130" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 1913px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">不走elsif</div></div></div></foreignObject><text x="105" y="1917" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">不走elsif</text></switch></g><rect x="380" y="1578" width="400" height="190" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 398px; height: 1px; padding-top: 1673px; margin-left: 381px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>需要移动节点<br />refNode = nextChildren[i-1].el.nextSibling<br />因为在patchElement里nextVNode.el = prevVnode.el</span><br /><span>这里</span>nextChildren[i-1]指的是3<br /><span>我们找到</span>prevChildren里3下面没有nextSibling了<br />所以refNode = null<br />而prevVnode.el 就是prevVNode的2<br /><span>然后执行container.insertBefore(prevVnode.el,</span>refNode<span>)<br />实际执行的就是</span>container.insertBefore(2,null)<br /><span><br /></span></div></div></div></foreignObject><text x="580" y="1677" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">需要移动节点refNode = nextChildren[i-1].el.nextSibling...</text></switch></g><path d="M 210 1673 L 373.63 1673" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 378.88 1673 L 371.88 1676.5 L 373.63 1673 L 371.88 1669.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1673px; margin-left: 295px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">if( j &lt; lastIndex )</div></div></div></foreignObject><text x="295" y="1676" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">if( j &lt; la...</text></switch></g><rect x="475" y="1848" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 1913px; margin-left: 476px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>prevVNode<br /></span><span>{ key:'b',value:'4' }</span><br /><span>{ key:'c',value:'1' }<br /></span>{ key:'a',value:'3' }<br /><span>{ key:'d',value:'2' }</span></div></div></div></foreignObject><text x="580" y="1917" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">prevVNode...</text></switch></g><path d="M 580 1768 L 580 1841.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 580 1846.88 L 576.5 1839.88 L 580 1841.63 L 583.5 1839.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1807px; margin-left: 578px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">更新<span style="font-size: 12px ; background-color: rgb(248 , 249 , 250)">container</span></div></div></div></foreignObject><text x="578" y="1810" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">更新container</text></switch></g><path d="M 105.6 1509 L 105.04 1601.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 105.01 1606.88 L 101.55 1599.86 L 105.04 1601.63 L 108.55 1599.9 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>
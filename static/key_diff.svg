<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="782px" height="1979px" viewBox="-0.5 -0.5 782 1979" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2021-05-25T11:38:27.555Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36&quot; etag=&quot;kGUuoeEeJ6DhdZX7oI5w&quot; version=&quot;14.6.11&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;6f77arHMxLuqO6wJHb2z&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g><path d="M 105 360 L 105 400 L 106 400 L 106 433.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 106 438.88 L 102.5 431.88 L 106 433.63 L 109.5 431.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 399px; margin-left: 107px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">else if( j &gt; lastIndex )</div></div></div></foreignObject><text x="107" y="402" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">else if( j &gt; lastIndex )</text></switch></g><rect x="0" y="230" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 295px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">第一次循环<br />lastIndex默认等于0<br />先找nextVNode的第一个元素4<br />nextVNode.key和prevVNode.key都等于c时<br />i = 0;(i表示nextVNode循环时的下标)<br />j = 2;(j表示prevVNode循环时的下标)</div></div></div></foreignObject><text x="105" y="299" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">第一次循环lastIndex默认等于0...</text></switch></g><rect x="1" y="440" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 505px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>lastIndex = j </span><br /><span>当前lastIndex等于2</span></div></div></div></foreignObject><text x="106" y="509" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">lastIndex = j...</text></switch></g><rect x="381" y="230" width="210" height="130" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 295px; margin-left: 382px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>不走if<br />需要移动节点</span></div></div></div></foreignObject><text x="486" y="299" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">不走if...</text></switch></g><rect x="0" y="0" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 65px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>prevVNode<br />{ key:'a',value:'1' }<br /></span><span>{ key:'b',value:'2' }</span><br /><span>{ key:'c',value:'4' }</span><br /><span>{ key:'d',value:'3' }</span></div></div></div></foreignObject><text x="105" y="69" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">prevVNode...</text></switch></g><rect x="381" y="0" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 65px; margin-left: 382px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>nextVNode<br />{ key:'c',value:'4' }<br /></span><span>{ key:'a',value:'1' }</span><br /><span>{ key:'d',value:'3' }</span><br /><span>{ key:'b',value:'2' }</span></div></div></div></foreignObject><text x="486" y="69" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">nextVNode...</text></switch></g><path d="M 210 295 L 374.63 295" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 379.88 295 L 372.88 298.5 L 374.63 295 L 372.88 291.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 295px; margin-left: 296px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">if( j &lt; lastIndex )</div></div></div></foreignObject><text x="296" y="298" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">if( j &lt; la...</text></switch></g><path d="M 106 780 L 106 883.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 106 888.88 L 102.5 881.88 L 106 883.63 L 109.5 881.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 833px; margin-left: 108px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">else if( j &gt; lastIndex )</div></div></div></foreignObject><text x="108" y="836" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">else if( j &gt; lastIndex )</text></switch></g><rect x="1" y="650" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 715px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">第二次循环<br />lastIndex等于2<br />找nextVNode的第二个元素3<br />nextVNode.key和prevVNode.key都等于a时<br />i = 1;(i表示nextVNode循环时的下标)<br />j = 0;(j表示prevVNode循环时的下标)</div></div></div></foreignObject><text x="106" y="719" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">第二次循环lastIndex等于2...</text></switch></g><rect x="1" y="890" width="210" height="130" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 955px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">不走elsif</div></div></div></foreignObject><text x="106" y="959" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">不走elsif</text></switch></g><rect x="381" y="620" width="400" height="190" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 398px; height: 1px; padding-top: 715px; margin-left: 382px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>需要移动节点<br />refNode = nextChildren[i-1].el.nextSibling<br />因为在patchElement里nextVNode.el = prevVnode.el<br />所以</span>nextChildren[i-1].el<span> = prev</span>Children[i-1].el<br /><span>这里</span>nextChildren[i-1]指的是4<br /><span>我们找到</span>prevChildren里4的nextSibling为3<br />所以refNode = 3<br />而prevVnode.el 就是prevVNode的1<br /><span>然后执行container.insertBefore(prevVnode.el,</span>refNode<span>)<br />实际执行的就是</span>container.insertBefore(1,3)<br /><span><br /></span></div></div></div></foreignObject><text x="581" y="719" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">需要移动节点refNode = nextChildren[i-1].el.nextSibling...</text></switch></g><path d="M 211 715 L 374.63 715" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 379.88 715 L 372.88 718.5 L 374.63 715 L 372.88 711.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 715px; margin-left: 296px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">if( j &lt; lastIndex )</div></div></div></foreignObject><text x="296" y="718" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">if( j &lt; la...</text></switch></g><rect x="476" y="890" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 955px; margin-left: 477px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>prevVNode<br /></span><span>{ key:'b',value:'2' }</span><br /><span>{ key:'c',value:'4' }<br /></span>{ key:'a',value:'1' }<br /><span>{ key:'d',value:'3' }</span></div></div></div></foreignObject><text x="581" y="959" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">prevVNode...</text></switch></g><path d="M 581 810 L 581 883.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 581 888.88 L 577.5 881.88 L 581 883.63 L 584.5 881.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 849px; margin-left: 579px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">更新<span style="font-size: 12px ; background-color: rgb(248 , 249 , 250)">container</span></div></div></div></foreignObject><text x="579" y="852" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">更新container</text></switch></g><path d="M 106 570 L 106 643.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 106 648.88 L 102.5 641.88 L 106 643.63 L 109.5 641.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 486 130 L 486 171 Q 486 181 476 181 L 115 181 Q 105 181 105 191 L 105 223.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 105 228.88 L 101.5 221.88 L 105 223.63 L 108.5 221.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 210 65 L 381 65" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 106 1269 L 106 1372.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 106 1377.88 L 102.5 1370.88 L 106 1372.63 L 109.5 1370.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1322px; margin-left: 108px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">else if( j &gt; lastIndex )</div></div></div></foreignObject><text x="108" y="1325" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">else if( j &gt; lastIndex )</text></switch></g><rect x="1" y="1139" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 1204px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">第三次循环<br />lastIndex等于2<br />找nextVNode的第三个元素3<br />nextVNode.key和prevVNode.key都等于d时<br />i = 2;<br />j = 3;</div></div></div></foreignObject><text x="106" y="1208" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">第三次循环lastIndex等于2...</text></switch></g><rect x="1" y="1379" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 1444px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>lastIndex = j </span><br /><span>当前lastIndex等于3</span></div></div></div></foreignObject><text x="106" y="1448" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">lastIndex = j...</text></switch></g><path d="M 214 1204 L 469.63 1204" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 474.88 1204 L 467.88 1207.5 L 469.63 1204 L 467.88 1200.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1204px; margin-left: 345px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">if( j &lt; lastIndex )</div></div></div></foreignObject><text x="345" y="1207" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">if( j &lt; la...</text></switch></g><path d="M 581 1022 L 581 1060 Q 581 1070 571 1070 L 116 1070 Q 106 1070 106 1080 L 106 1132.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 106 1137.88 L 102.5 1130.88 L 106 1132.63 L 109.5 1130.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="476" y="1139" width="210" height="130" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 1204px; margin-left: 477px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>不走if<br />需要移动节点</span></div></div></div></foreignObject><text x="581" y="1208" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">不走if...</text></switch></g><path d="M 105 1738 L 105 1841.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 105 1846.88 L 101.5 1839.88 L 105 1841.63 L 108.5 1839.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1791px; margin-left: 107px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">else if( j &gt; lastIndex )</div></div></div></foreignObject><text x="107" y="1794" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">else if( j &gt; lastIndex )</text></switch></g><rect x="0" y="1608" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 1673px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">第四次循环<br />lastIndex等于3<br />找nextVNode的第四个元素2<br />nextVNode.key和prevVNode.key都等于b时<br />i = 3;(i表示nextVNode循环时的下标)<br />j = 1;(j表示prevVNode循环时的下标)</div></div></div></foreignObject><text x="105" y="1677" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">第四次循环lastIndex等于3...</text></switch></g><rect x="0" y="1848" width="210" height="130" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 1913px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">不走elsif</div></div></div></foreignObject><text x="105" y="1917" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">不走elsif</text></switch></g><rect x="380" y="1578" width="400" height="190" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 398px; height: 1px; padding-top: 1673px; margin-left: 381px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>需要移动节点<br />refNode = nextChildren[i-1].el.nextSibling<br />因为在patchElement里nextVNode.el = prevVnode.el<br />所以</span>nextChildren[i-1].el<span> = prev</span>Children[i-1].el<br /><span>这里</span>nextChildren[i-1]指的是3<br /><span>我们找到</span>prevChildren里3下面没有nextSibling了<br />所以refNode = null<br />而prevVnode.el 就是prevVNode的2<br /><span>然后执行container.insertBefore(prevVnode.el,</span>refNode<span>)<br />实际执行的就是</span>container.insertBefore(2,null)<br /><span><br /></span></div></div></div></foreignObject><text x="580" y="1677" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">需要移动节点refNode = nextChildren[i-1].el.nextSibling...</text></switch></g><path d="M 210 1673 L 373.63 1673" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 378.88 1673 L 371.88 1676.5 L 373.63 1673 L 371.88 1669.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1673px; margin-left: 295px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">if( j &lt; lastIndex )</div></div></div></foreignObject><text x="295" y="1676" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">if( j &lt; la...</text></switch></g><rect x="475" y="1848" width="210" height="130" fill="#d5e8d4" stroke="#82b366" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 208px; height: 1px; padding-top: 1913px; margin-left: 476px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span>prevVNode<br /></span><span>{ key:'b',value:'4' }</span><br /><span>{ key:'c',value:'1' }<br /></span>{ key:'a',value:'3' }<br /><span>{ key:'d',value:'2' }</span></div></div></div></foreignObject><text x="580" y="1917" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">prevVNode...</text></switch></g><path d="M 580 1768 L 580 1841.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 580 1846.88 L 576.5 1839.88 L 580 1841.63 L 583.5 1839.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1807px; margin-left: 578px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">更新<span style="font-size: 12px ; background-color: rgb(248 , 249 , 250)">container</span></div></div></div></foreignObject><text x="578" y="1810" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">更新container</text></switch></g><path d="M 105.6 1509 L 105.04 1601.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 105.01 1606.88 L 101.55 1599.86 L 105.04 1601.63 L 108.55 1599.9 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>